.catalog:
  name: Jenkins
  version: 1.642.2-rancher1
  description: |
    Jenkins CI management server.
  questions:
  - variable: "fqdn"
    label: "LB FQDN"
    description: "App name for FQDN"
    type: "string"
    required: true
    default: "jenkins"

  - variable: "plugins"
    type: "multiline"
    label: "List of Plugins"
    description: |
      List of plugins in the format <plugin_name>[:<version>]
      one entry per line.
    default: |
      credentials 
      git 
      git-client 
      github 
      github-api 
      github-oauth 
      greenballs 
      junit 
      plain-credentials 
      scm-api 
      ssh-credentials 
      ssh-slaves 
      swarm
 
jenkins-primary:
  metadata:
    plugins: |
      ${plugins}

jenkins-primary-lb:
    scale: 1
    start_on_create: true
    lb_config:
      certs: []
      port_rules:
      - hostname: ${fqdn}
        priority: 1
        protocol: http
        service: jenkins-primary
        source_port: 8082
        target_port: 8080
    health_check:
      response_timeout: 2000
      healthy_threshold: 2
      port: 42
      unhealthy_threshold: 3
      interval: 2000
